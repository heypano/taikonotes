(this.webpackJsonptaikonotes=this.webpackJsonptaikonotes||[]).push([[0],{20:function(n,e,t){},26:function(n,e,t){"use strict";t.r(e);var o=t(0),s=t(8),i=t.n(s),c=(t(20),t(2)),d=t(3),r=t(10),a="main",u=function(n){return Object(c.d)((function(e){return e.main.sections[n].settings}),c.b)},l=function(n){return Object(c.d)((function(e){return e.main.sections[n].settings.soundObj}),c.b)},b=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{cells:[],id:n,sectionName:"Line ".concat(n),totalLines:1}},j=Object(r.b)({name:a,initialState:{sections:[{cells:[{sound:"don"},null,{sound:"ka",intensity:1},{sound:"don"},{sound:""},{sound:"ka",intensity:1},{sound:"don"},{sound:""},{sound:"don",intensity:1},null,{sound:"don",intensity:1},null,{sound:"do"},{sound:"ko"},{sound:"don",intensity:1},null,{sound:"do"},{sound:"ro"},{sound:"tsu"},{sound:"ku"},{sound:"su"},{sound:"ka",intensity:1},{sound:"ra",intensity:1},null,{sound:"do"},{sound:"kon",intensity:1},{sound:""},{sound:"ka",intensity:1},{sound:"su"},{sound:"ko"},{sound:"do"},{sound:"ko"},{sound:"don",intensity:1},null,null,{sound:"ko"},{sound:"don",intensity:1},{sound:"doko"},{sound:"kara",intensity:1},{sound:"don",intensity:1},{sound:"su"},{sound:"kon",intensity:1},null,{sound:"don",intensity:1},null,{sound:"ko"},{sound:"do",intensity:1},{sound:"do",intensity:1},{sound:"su"},{sound:"ka",intensity:1},{sound:"don",intensity:1},null,{sound:"su"},{sound:"do"},{sound:"ka",intensity:1},null,{sound:"su"},{sound:"don",intensity:1},null,null,{sound:"don",intensity:1}],id:1,sectionName:"Line 1",totalLines:4,settings:{cellsPerLine:16,divideEvery:2,sounds:"don, kon, ka, do, ko, ro, su, tsu,ku, kara, ra, doko",soundObj:{don:"don",kon:"kon",ka:"ka",do:"do",ko:"ko",ro:"ro",su:"su",tsu:"tsu",ku:"ku",kara:"kara",ra:"ra",doko:"doko"}}},{cells:[{sound:"don"},null,{sound:"ka",intensity:1},{sound:"don"},{sound:""},{sound:"ka",intensity:1},{sound:"don"},{sound:""},{sound:"don",intensity:1},null,{sound:"don",intensity:1},null,{sound:"do"},{sound:"ko"},{sound:"don",intensity:1},null,{sound:"do"},{sound:"ro"},{sound:"tsu"},{sound:"ku"},{sound:"su"},{sound:"ka",intensity:1},{sound:"ra",intensity:1},null,{sound:"do"},{sound:"kon",intensity:1},{sound:""},{sound:"ka",intensity:1},{sound:"su"},{sound:"ko"},{sound:"do"},{sound:"ko"},{sound:"don",intensity:1},null,null,{sound:"ko"},{sound:"don",intensity:1},{sound:"doko"},{sound:"kara",intensity:1},{sound:"don",intensity:1},{sound:"su"},{sound:"kon",intensity:1},null,{sound:"don",intensity:1},null,{sound:"ko"},{sound:"do",intensity:1},{sound:"do",intensity:1},{sound:"su"},{sound:"ka",intensity:1},{sound:"don",intensity:1},null,{sound:"su"},{sound:"do"},{sound:"ka",intensity:1},null,{sound:"su"},{sound:"don",intensity:1},null,null,{sound:"don",intensity:1}],id:2,sectionName:"Line 2",totalLines:4,settings:{cellsPerLine:4,divideEvery:2,sounds:"don, kon, ka",soundObj:{don:"don",kon:"kon",ka:"ka"}}}]},reducers:{clearState:function(n,e){n.sections=[b()]},setSettings:function(n,e){var t=e.payload,o=t.sectionId,s=t.settings;Object.keys(s).forEach((function(e){n.sections[o].settings[e]=s[e]})),n.sections[o].settings.soundObj=Object.fromEntries(n.sections[o].settings.sounds.split(",").map((function(n){return[n.trim(),n.trim()]})))},setTotalLines:function(n,e){var t=e.payload,o=t.sectionIndex,s=t.totalLines,i=Math.max(s,1),c=n.sections[o].settings.cellsPerLine;n.sections[o].totalLines=i,n.sections[o].cells=n.sections[o].cells.slice(0,i*c)},setSectionName:function(n,e){var t=e.payload,o=t.sectionIndex,s=t.sectionName;n.sections[o].sectionName=s},setSound:function(n,e){var t=e.payload,o=t.sectionIndex,s=t.cellIndex,i=t.sound,c=n.sections[o].cells[s]||{};c.sound=i,n.sections[o].cells[s]=c},setIntensity:function(n,e){var t=e.payload,o=t.sectionIndex,s=t.cellIndex,i=t.intensity,c=n.sections[o].cells[s]||{};c.intensity=i,n.sections[o].cells[s]=c},setMainState:function(n,e){return e.payload},addSection:function(n,e){n.sections.push(b(n.sections.length+1))},removeLastSection:function(n,e){n.sections.pop()}}}),f=j.actions,v=(f.setCellsPerLine,f.setDivideEvery,f.setTotalLines),m=f.setSectionName,O=(f.setSounds,f.setSettings),p=f.setSound,x=f.setIntensity,h=f.setMainState,g=f.addSection,k=f.removeLastSection,y=f.clearState,C=j.reducer,w=t(5);function L(n){return function(e){"Enter"===e.key&&n(e)}}function N(n){return function(e){" "===e.key&&n(e)}}var I=t(0).useEffect;var S=t(1),P=function(n){var e=n.open,t=n.onOpenChange,s=n.className,i=n.style,c=n.children,r=n.left,a=n.top,u=Object(o.useRef)(),l=Object(o.useState)(),b=Object(w.a)(l,2),j=b[0],f=b[1],v=Object(o.useCallback)((function(n){e&&(t(!1),n.stopPropagation())}),[e,t]);!function(n,e){I((function(){var t=function(t){n.current&&!n.current.contains(t.target)&&e(t)};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),document.addEventListener("keypress",t),function(){document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t),document.removeEventListener("keypress",t)}}),[n,e])}(u,v),Object(o.useEffect)((function(){if(u.current&&void 0!==r&&void 0!==a){var n=window.innerWidth-u.current.clientWidth,e=window.innerHeight-u.current.clientHeight,t=Math.max(Math.min(r,n),10),o=Math.max(Math.min(a,e),10);f({left:t,top:o})}else f(null)}),[r,e,a]);var m=j?"":"invisible",O=function(n){n.preventDefault(),n.stopPropagation()};return e&&Object(S.jsx)("div",{ref:u,className:"popupmenu ".concat(m," ").concat(s),style:Object(d.a)(Object(d.a)({},i),j||{}),onClick:O,onKeyPress:O,role:"none",children:c})};P.defaultProps={className:"",style:null,children:void 0,left:void 0,top:void 0};var E=P,M=function(n){var e=n.cellIndex,t=n.open,s=n.onOpenChange,i=n.sectionIndex,d=n.menuCoordinates,r=l(i),a=Math.ceil(Object.keys(r).length/4),u=Object(c.c)(),b=Object(o.useRef)();return Object(o.useEffect)((function(){t&&setTimeout((function(){b.current&&b.current.focus()}),0)}),[t]),console.debug("CellPopupMenu rerender"),t&&Object(S.jsx)(E,{className:"grid grid-rows-4 grid-cols-".concat(a," grid-flow-col w-max max-h-48"),open:t,onOpenChange:s,left:d[0],top:d[1],children:Object.values(r).map((function(n,t){var o=function(t){u(p({cellIndex:e,sectionIndex:i,sound:n})),s(!1)};return Object(S.jsx)("div",{ref:0===t?b:null,className:"p-3 hover:bg-blue-200 ",role:"button",tabIndex:0,onClick:o,onKeyPress:function(n){L((function(){s(!1)}))(n),N(o)(n)},children:n},n)}))})};M.defaultProps={menuCoordinates:void 0};var D=Object(o.memo)(M),B=function(n){var e=n.cellIndex,t=n.sectionIndex,s=n.isPlaying,i=n.isStartingCell,d=n.isFirstCellInLine,r=n.cellsPerLine,a=Object(o.useRef)(),u=Object(c.c)(),b=l(t),j=Object(o.useState)(!1),f=Object(w.a)(j,2),v=f[0],m=f[1],O=Object(o.useState)(),p=Object(w.a)(O,2),h=p[0],g=p[1],k=Object(o.useCallback)((function(n){m(n),a.current&&!n&&a.current.focus()}),[]),y=function(n,e){return Object(c.d)((function(t){return t.main.sections[n].cells[e]||{}}),c.b)}(t,e),C=y.sound,I=void 0===C?0:C,P=y.intensity,E=I&&b[I]||"",M="bg-white hover:bg-blue-400";s?M="bg-red-300 hover:bg-red-600":i&&(M="bg-gray-300 hover:bg-blue-400");var B="border border-blue-800";d&&r%2===1&&(B="border-2 border-red-400 md:border md:border-blue-800"),console.debug("Cell rerender ".concat(e));var R=function(n){if(m(!v),n.clientX&&n.clientY)g([n.clientX,n.clientY]);else if(n.target){var e=n.target.getBoundingClientRect(),t=e.x,o=e.y;g([t,o])}n.preventDefault()},T=function(n){u(x({cellIndex:e,sectionIndex:t,intensity:P?0:1})),n.preventDefault()};return Object(S.jsxs)("div",{ref:a,className:"fadeBg flex flex-row justify-center items-center select-none h-10 cursor-pointer ".concat(B," ").concat(M),role:"button",tabIndex:0,onContextMenu:T,onClick:R,onKeyPress:function(n){L(T)(n),N(R)(n)},children:[P?E.toLocaleUpperCase():E,Object(S.jsx)(D,{open:v,menuCoordinates:h,onOpenChange:k,cellIndex:e,sectionIndex:t})]})};B.defaultProps={isPlaying:void 0};var R=Object(o.memo)(B),T=t(14),W=["children","className"],_=function(n){var e=n.children,t=n.className,o=Object(T.a)(n,W);return Object(S.jsx)("button",Object(d.a)(Object(d.a)({type:"button",className:"p-3 bg-blue-100 text-gray-800 cursor-pointer hover:bg-blue-50 ".concat(t)},o),{},{children:e}))};_.defaultProps={className:void 0,children:void 0};var J=Object(o.memo)(_),K=function(n){var e=n.children,t=n.onClick;return Object(S.jsx)(J,{className:"mr-2",onClick:t,onKeyPress:function(n){n.preventDefault(),n.stopPropagation()},children:e})},X=Object(o.memo)(K);function Y(){return Object(S.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[Object(S.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),Object(S.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}var A=t(6),F=t(15),z=function(n){var e=n.children,t=n.id;return Object(S.jsx)("label",{htmlFor:t,className:"flex flex-row justify-between items-end mt-3 first:mt-0",children:e})};z.defaultProps={id:void 0,children:void 0};var G=Object(F.a)(Array(20).keys()).map((function(n){return n+1})),H=function(n){var e=n.sectionId,t=u(e),s=Object(c.c)(),i=t.cellsPerLine,d=void 0===i?16:i,r=t.divideEvery,a=void 0===r?4:r,l=t.sounds,b=void 0===l?"ka,don":l,j=Object(o.useCallback)((function(n){var t=n.target,o=t.name,i=t.value,c="number"===t.dataType?Number(i):i;s(O({sectionId:e,settings:Object(A.a)({},o,c)}))}),[s,e]);return Object(S.jsxs)("form",{className:"flex flex-col ",children:[Object(S.jsxs)(z,{children:["Cells Per Line",Object(S.jsx)("select",{id:"cellsPerLine",name:"cellsPerLine",className:"p-2 ",onChange:j,value:d,"data-data-type":"number",children:G.map((function(n){return Object(S.jsx)("option",{value:n,children:n},"cellsPerLine_".concat(n))}))})]}),Object(S.jsxs)(z,{children:["Divide every",Object(S.jsx)("select",{id:"divideEvery",name:"divideEvery",className:"p-2 ",onChange:j,value:a,"data-data-type":"number",children:G.map((function(n){return Object(S.jsx)("option",{value:n,children:n},"defaultDivideEvery_".concat(n))}))})]}),Object(S.jsxs)(z,{id:b,children:["Available Sounds",Object(S.jsx)("input",{id:"sounds",name:"sounds",className:"border-black border p-1 ml-5",onChange:j,value:b})]})]})};H.defaultProps={};var U=Object(o.memo)(H),$=function(n){var e=n.sectionId,t=n.open,o=n.onOpenChange,s=n.left,i=n.top;return Object(S.jsx)(E,{open:t,onOpenChange:o,left:s,top:i,className:"grid grid-rows-1 grid-cols-1 w-max max-h-48 p-4",children:Object(S.jsx)(U,{sectionId:e})})};$.defaultProps={left:void 0,top:void 0};var q=$,Q=function(n){var e,t=n.sectionId,s=u(t),i=s.cellsPerLine,r=s.divideEvery,a=Object(o.useState)(!1),l=Object(w.a)(a,2),b=l[0],j=l[1],f=Object(c.c)(),O=(e=t,Object(c.d)((function(n){var t=n.main.sections,o=Object(d.a)({},t[e]);return delete o.cells,o}),c.b)),p=O.sectionName,x=O.totalLines,h=O.id,g=[],k=i*x,y=Object(o.useState)(),C=Object(w.a)(y,2),L=C[0],N=C[1],I=Object(o.useState)(),P=Object(w.a)(I,2),E=P[0],M=P[1],D=i>7?Math.floor(i/2):i;console.debug("Section rerender ".concat(p," - ").concat(h));for(var B=0;B<k;B++)g.push(Object(S.jsx)(R,{isStartingCell:B%r===0,isFirstCellInLine:B%i===0,cellsPerLine:i,cellIndex:B,sectionIndex:t},"cell_".concat(t,"_").concat(B)));return Object(S.jsxs)("div",{className:"mb-8 p-1",children:[Object(S.jsxs)("div",{className:"flex flex-row align-baseline",children:[Object(S.jsx)(X,{onClick:function(){f(v({sectionIndex:t,totalLines:x+1}))},children:"+"}),Object(S.jsx)(X,{onClick:function(){f(v({sectionIndex:t,totalLines:x-1}))},children:"-"}),Object(S.jsxs)(X,{onClick:function(n){if(j(!0),n.clientX&&n.clientY)N(n.clientX),M(n.clientY);else if(n.target){var e=n.target.getBoundingClientRect(),t=e.x,o=e.y;N(t),M(o)}n.preventDefault(),n.stopPropagation()},children:[Object(S.jsx)(Y,{}),Object(S.jsx)(q,{sectionId:t,open:b,onOpenChange:function(n){j(n)},left:L,top:E})]}),Object(S.jsx)("input",{type:"text",value:p,className:"text-2xl w-full outline-none",onChange:function(n){f(m({sectionIndex:t,sectionName:n.target.value}))}})]}),Object(S.jsx)("div",{className:"bg-blue-500 grid grid-cols-".concat(D," md:grid-cols-").concat(i," border border-blue-800"),children:g})]},"section_".concat(t))};Q.defaultProps={sectionId:void 0};var V=Object(o.memo)(Q),Z={reducer:Object(A.a)({},a,C)},nn=Object(r.a)(Z),en="taikoNotesState",tn=function(){var n=nn.getState().main;localStorage.setItem(en,JSON.stringify(n))},on=function(){var n=Object(c.c)();return Object(S.jsxs)("div",{className:"settings p-1 mt-3 mb-3 flex flex-col md:flex-row",children:[Object(S.jsx)("div",{className:"w-full md:w-8/12 lg:w-6/12 grid logoGrid mr-3",children:Object(S.jsx)("img",{src:"".concat("","/favicon/Taiko.svg"),className:"w-full p-2",alt:"taiko logo"})}),Object(S.jsx)("div",{className:"w-full md:w-4/12 lg:w-6/12 flex flex-col justify-between",children:Object(S.jsxs)("div",{className:"mt-2 md:mt-0 grid grid-rows-2 grid-flow-col gap-1",children:[Object(S.jsx)(J,{onClick:function(){n(g())},children:"Add Section"}),Object(S.jsx)(J,{onClick:function(){n(k())},children:"Remove Last Section"}),Object(S.jsx)(J,{onClick:function(){tn()},children:"Save"}),Object(S.jsx)(J,{onClick:function(){var e=function(){var n=localStorage.getItem(en);return n?JSON.parse(n):null}();console.debug("entire state",e),n(h(e))},children:"Load"}),Object(S.jsx)(J,{onClick:function(){n(y())},children:"Clear"})]})})]})};on.defaultProps={};var sn=Object(o.memo)(on),cn=function(){var n=Object(c.d)((function(n){return n.main.sections.map((function(n){return n.id}))}),c.b);return console.debug("TaikoGrid rerender"),Object(S.jsxs)("div",{children:[Object(S.jsx)(sn,{}),Object(S.jsx)("div",{children:n.map((function(n,e){return Object(S.jsx)(V,{sectionId:e},n)}))})]})},dn=Object(o.memo)(cn),rn=function(n){var e=n.children;return Object(S.jsx)("div",{className:"container mx-auto",children:e})};rn.defaultProps={children:"asd"};var an=rn;var un=function(){return Object(S.jsx)(c.a,{store:nn,children:Object(S.jsx)("div",{className:"app",children:Object(S.jsx)(an,{children:Object(S.jsx)(dn,{})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(S.jsx)(un,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(n){n.unregister()}))}},[[26,1,2]]]);
//# sourceMappingURL=main.f5146f63.chunk.js.map