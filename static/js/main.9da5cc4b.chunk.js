(this.webpackJsonptaikonotes=this.webpackJsonptaikonotes||[]).push([[0],{20:function(e,n,t){},26:function(e,n,t){"use strict";t.r(n);var s=t(0),c=t(8),o=t.n(c),i=(t(20),t(2)),d=t(5),a=t(11),l=t(4),r=t(10),u="main",x=function(){return Object(i.d)((function(e){return e.main.settings}),i.b)},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{cells:[],id:e,name:"Line ".concat(e),totalLines:1}},j=Object(r.b)({name:u,initialState:{sections:[{cells:[{soundIndex:1},null,{soundIndex:3,intensity:1},{soundIndex:1},{soundIndex:0},{soundIndex:3,intensity:1},{soundIndex:1},{soundIndex:0},{soundIndex:1,intensity:1},null,{soundIndex:1,intensity:1},null,{soundIndex:4},{soundIndex:5},{soundIndex:1,intensity:1},null,{soundIndex:4},{soundIndex:6},{soundIndex:8},{soundIndex:9},{soundIndex:7},{soundIndex:3,intensity:1},{soundIndex:11,intensity:1},null,{soundIndex:4},{soundIndex:2,intensity:1},{soundIndex:0},{soundIndex:3,intensity:1},{soundIndex:7},{soundIndex:5},{soundIndex:4},{soundIndex:5},{soundIndex:1,intensity:1},null,null,{soundIndex:5},{soundIndex:1,intensity:1},{soundIndex:12},{soundIndex:10,intensity:1},{soundIndex:1,intensity:1},{soundIndex:7},{soundIndex:2,intensity:1},null,{soundIndex:1,intensity:1},null,{soundIndex:5},{soundIndex:4,intensity:1},{soundIndex:4,intensity:1},{soundIndex:7},{soundIndex:3,intensity:1},{soundIndex:1,intensity:1},null,{soundIndex:7},{soundIndex:4},{soundIndex:3,intensity:1},null,{soundIndex:7},{soundIndex:1,intensity:1},null,null,{soundIndex:1,intensity:1}],id:1,sectionName:"Line 1",totalLines:4},{cells:[],id:2,sectionName:"Line 2",totalLines:1}],settings:{cellsPerLine:16,divideEvery:2,sounds:"don, kon, ka, do, ko, ro, su, tsu,ku, kara, ra, doko"}},reducers:{clearState:function(e,n){e.sections=[b()]},setSettings:function(e,n){Object.keys(n.payload).forEach((function(t){e.settings[t]=n.payload[t]}))},setTotalLines:function(e,n){var t=n.payload,s=t.sectionIndex,c=t.totalLines,o=Math.max(c,1),i=e.settings.cellsPerLine;e.sections[s].totalLines=o,e.sections[s].cells=e.sections[s].cells.slice(0,o*i)},setSectionName:function(e,n){var t=n.payload,s=t.sectionIndex,c=t.sectionName;e.sections[s].sectionName=c},setSoundIndex:function(e,n){var t=n.payload,s=t.sectionIndex,c=t.cellIndex,o=t.soundIndex,i=e.sections[s].cells[c]||{};i.soundIndex=o,e.sections[s].cells[c]=i},setIntensity:function(e,n){var t=n.payload,s=t.sectionIndex,c=t.cellIndex,o=t.intensity,i=e.sections[s].cells[c]||{};i.intensity=o,e.sections[s].cells[c]=i},setMainState:function(e,n){return n.payload},addSection:function(e,n){e.sections.push(b(e.sections.length+1))},removeLastSection:function(e,n){e.sections.pop()}}}),m=j.actions,f=(m.setCellsPerLine,m.setDivideEvery,m.setTotalLines),v=m.setSectionName,O=(m.setSounds,m.setSettings),I=m.setSoundIndex,h=m.setIntensity,p=m.setMainState,y=m.addSection,g=m.removeLastSection,N=m.clearState,w=j.reducer,S=t(1),L=Object(a.a)(Array(20).keys()).map((function(e){return e+1})),k=function(){var e=x(),n=Object(i.c)(),t=e.cellsPerLine,s=e.divideEvery,c=e.sounds,o=function(e){var t=e.target,s=t.name,c=t.value,o="number"===t.dataType?Number(c):c;n(O(Object(d.a)({},s,o)))};return Object(S.jsxs)("form",{onSubmit:function(){},className:"flex flex-col ",children:[Object(S.jsxs)("div",{className:"flex flex-row justify-between",children:[Object(S.jsx)("label",{children:"Cells Per Line"}),Object(S.jsx)("select",{name:"cellsPerLine",className:"p-2 ",onChange:o,value:t,"data-data-type":"number",children:L.map((function(e){return Object(S.jsx)("option",{value:e,children:e},"cellsPerLine_".concat(e))}))})]}),Object(S.jsxs)("div",{className:"flex flex-row justify-between",children:[Object(S.jsx)("label",{children:"Divide every"}),Object(S.jsx)("select",{name:"divideEvery",className:"p-2 ",onChange:o,value:s,"data-data-type":"number",children:L.map((function(e){return Object(S.jsx)("option",{value:e,children:e},"defaultDivideEvery_".concat(e))}))})]}),Object(S.jsxs)("div",{className:"flex flex-row justify-between items-end mt-3",children:[Object(S.jsx)("label",{children:"Available Sounds"}),Object(S.jsx)("input",{name:"sounds",className:"border-black border p-1",onChange:o,value:c})]})]})};k.defaultProps={};var C=Object(s.memo)(k),P=t(15),E=["children","className"],M=function(e){var n=e.children,t=e.className,s=Object(P.a)(e,E);return Object(S.jsx)("button",Object(l.a)(Object(l.a)({type:"button",className:"p-3 bg-blue-100 text-gray-800 cursor-pointer hover:opacity-75 ".concat(t)},s),{},{children:n}))};M.defaultProps={className:void 0,children:void 0};var A=Object(s.memo)(M),D={reducer:Object(d.a)({},u,w)},T=Object(r.a)(D),_="taikoNotesState",J=function(){var e=T.getState().main;localStorage.setItem(_,JSON.stringify(e))},W=t(7),B=t(0).useEffect;var H=function(e){var n=e.cellIndex,t=e.open,c=e.onOpenChange,o=e.soundArray,d=e.sectionIndex,a=e.menuCoordinates,l=Math.ceil(o.length/4),r=Object(i.c)(),u=Object(s.useRef)(),x=Object(s.useCallback)((function(e){c(!1),e.stopPropagation()}),[c]),b=Object(s.useState)(),j=Object(W.a)(b,2),m=j[0],f=j[1];return function(e,n){B((function(){var t=function(t){e.current&&!e.current.contains(t.target)&&n(t)};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),function(){document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)}}),[e,n])}(u,x),console.debug("PopupMenu rerender"),Object(s.useEffect)((function(){if(u.current&&a){var e=window.innerWidth-u.current.clientWidth,n=window.innerHeight-u.current.clientHeight,t=Math.max(Math.min(a[0]-10,e),10),s=Math.max(Math.min(a[1]-10,n),10);f({left:t,top:s})}else f(null)}),[t,a]),t&&Object(S.jsx)("div",{ref:u,className:"popupmenu grid grid-rows-4 grid-cols-".concat(l," w-max grid-flow-col max-h-48 ").concat(m?"":"invisible"," "),style:m,children:o.map((function(e,t){return Object(S.jsx)("div",{className:"p-3 hover:bg-blue-200 ",onClick:function(e){r(I({cellIndex:n,sectionIndex:d,soundIndex:t})),x(e)},children:e},t)}))})};H.defaultProps={menuCoordinates:void 0};var R=Object(s.memo)(H),G=function(e){var n,t=e.soundArray,c=void 0===t?[]:t,o=e.cellIndex,d=e.sectionIndex,a=e.isPlaying,l=e.isStartingCell,r=Object(i.c)(),u=Object(s.useState)(!1),x=Object(W.a)(u,2),b=x[0],j=x[1],m=Object(s.useState)(),f=Object(W.a)(m,2),v=f[0],O=f[1],I=Object(s.useCallback)((function(e){j(e)}),[]),p=function(e,n){return Object(i.d)((function(t){return t.main.sections[e].cells[n]||{}}),i.b)}(d,o),y=p.soundIndex,g=void 0===y?0:y,N=p.intensity,w=c[g]||"";return n=a?"bg-red-300 hover:bg-red-600":l?"bg-gray-300 hover:bg-blue-400":"hover:bg-blue-400",console.debug("Cell rerender ".concat(o)),Object(S.jsxs)("div",{className:"fadeBg flex flex-row justify-center items-center select-none border border-blue-800 h-10 cursor-pointer ".concat(n),onContextMenu:function(e){r(h({cellIndex:o,sectionIndex:d,intensity:N?0:1})),e.preventDefault()},onClick:function(e){j(!0),O([e.clientX,e.clientY]),e.preventDefault()},children:[N?w.toLocaleUpperCase():w,Object(S.jsx)(R,{open:b,menuCoordinates:v,onOpenChange:I,cellIndex:o,sectionIndex:d,soundArray:c})]})};G.defaultProps={isPlaying:void 0};var U=Object(s.memo)(G),X=function(e){var n,t=e.sectionId,c=x(),o=c.cellsPerLine,d=c.divideEvery,r=c.sounds,u=Object(i.c)(),b=(n=t,Object(i.d)((function(e){var t=e.main.sections,s=Object(l.a)({},t[n]);return delete s.cells,s}),i.b)),j=Object(s.useMemo)((function(){return[null].concat(Object(a.a)(r.split(",").map((function(e){return e.trim()}))))}),[r]),m=b.sectionName,O=b.totalLines,I=b.id,h=[],p=o*O,y=o>7?Math.floor(o/2):o;console.debug("Section rerender ".concat(m," - ").concat(I));for(var g=0;g<p;g++)h.push(Object(S.jsx)(U,{isStartingCell:g%d===0,cellsPerLine:o,cellIndex:g,sectionIndex:t,soundArray:j},"cell_".concat(t,"_").concat(g)));return Object(S.jsxs)("div",{className:"mb-8",children:[Object(S.jsxs)("div",{children:[Object(S.jsx)(A,{className:"mr-2",onClick:function(){u(f({sectionIndex:t,totalLines:O+1}))},children:"+"}),Object(S.jsx)(A,{className:"mr-2",onClick:function(){u(f({sectionIndex:t,totalLines:O-1}))},children:"-"}),Object(S.jsx)("input",{type:"text",value:m,className:"text-2xl  outline-none",onChange:function(e){u(v({sectionIndex:t,sectionName:e.target.value}))}})]}),Object(S.jsx)("div",{className:"grid grid-cols-".concat(y," md:grid-cols-").concat(o," border border-blue-800"),children:h})]},"section_".concat(t))};X.defaultProps={sectionId:void 0};var Y=Object(s.memo)(X),$=function(){var e=Object(i.c)(),n=Object(i.d)((function(e){return e.main.sections.map((function(e){return e.id}))}),i.b);return console.debug("TaikoGrid rerender"),Object(S.jsxs)("div",{children:[Object(S.jsxs)("div",{className:"settings mt-3 mb-3 p-3 flex flex-col md:flex-row",children:[Object(S.jsx)("img",{src:"".concat("","/favicon/Taiko.svg"),className:"w-1/12 pr-2",alt:"taiko logo"}),Object(S.jsx)("div",{className:"w-full md:w-6/12 lg:w-4/12 border border-blue-300 p-2 mr-auto w-full",children:Object(S.jsx)(C,{})}),Object(S.jsx)("div",{className:"w-full md:w-6/12 lg:w-4/12 flex flex-col justify-between",children:Object(S.jsxs)("div",{className:"grid grid-rows-2 grid-flow-col",children:[Object(S.jsx)(A,{onClick:function(){e(y())},className:"m-4",children:"Add Section"}),Object(S.jsx)(A,{onClick:function(){e(g())},className:"m-4",children:"Remove Last Section"}),Object(S.jsx)(A,{onClick:function(){J()},className:"m-4",children:"Save"}),Object(S.jsx)(A,{onClick:function(){var n=function(){var e=localStorage.getItem(_);return e?JSON.parse(e):null}();console.debug("entire state",n),e(p(n))},className:"m-4",children:"Load"}),Object(S.jsx)(A,{onClick:function(){e(N())},className:"m-4",children:"Clear"})]})})]}),Object(S.jsx)("div",{children:n.map((function(e,n){return Object(S.jsx)(Y,{sectionId:n},e)}))})]})},q=Object(s.memo)($),z=function(e){var n=e.children;return Object(S.jsx)("div",{className:"container mx-auto",children:n})};z.defaultProps={children:"asd"};var F=z;var K=function(){return Object(S.jsx)(i.a,{store:T,children:Object(S.jsx)("div",{className:"app",children:Object(S.jsx)(F,{children:Object(S.jsx)(q,{})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(S.jsx)(K,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[26,1,2]]]);
//# sourceMappingURL=main.9da5cc4b.chunk.js.map