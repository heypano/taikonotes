(this.webpackJsonptaikonotes=this.webpackJsonptaikonotes||[]).push([[0],{20:function(e,n,t){},26:function(e,n,t){"use strict";t.r(n);var o=t(1),s=t(9),i=t.n(s),c=(t(20),t(2)),d=t(3),r=t(6),l="main",a=function(e){return Object(c.d)((function(n){return n.main.sections[e].settings}),c.b)},u=function(e){return Object(c.d)((function(n){return void 0!==e?n.main.sections[e].settings.soundObj:null}),c.b)},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{cells:[],id:e,sectionName:"Line ".concat(e),totalLines:1,settings:{cellsPerLine:4,divideEvery:2,sounds:"don, kon, ka",soundObj:{"":"",don:"don",kon:"kon",ka:"ka"}}}},b=Object(r.b)({name:l,initialState:{sections:[{cells:[{sound:"don"},null,{sound:"ka",intensity:1},{sound:"don"},{sound:""},{sound:"ka",intensity:1},{sound:"don"},{sound:""},{sound:"don",intensity:1},null,{sound:"don",intensity:1},null,{sound:"do"},{sound:"ko"},{sound:"don",intensity:1},null,{sound:"do"},{sound:"ro"},{sound:"tsu"},{sound:"ku"},{sound:"su"},{sound:"ka",intensity:1},{sound:"ra",intensity:1},null,{sound:"do"},{sound:"kon",intensity:1},{sound:""},{sound:"ka",intensity:1},{sound:"su"},{sound:"ko"},{sound:"do"},{sound:"ko"},{sound:"don",intensity:1},null,null,{sound:"ko"},{sound:"don",intensity:1},{sound:"doko"},{sound:"kara",intensity:1},{sound:"don",intensity:1},{sound:"su"},{sound:"kon",intensity:1},null,{sound:"don",intensity:1},null,{sound:"ko"},{sound:"do",intensity:1},{sound:"do",intensity:1},{sound:"su"},{sound:"ka",intensity:1},{sound:"don",intensity:1},null,{sound:"su"},{sound:"do"},{sound:"ka",intensity:1},null,{sound:"su"},{sound:"don",intensity:1},null,null,{sound:"don",intensity:1}],id:1,sectionName:"Line 1",totalLines:4,settings:{cellsPerLine:16,divideEvery:2,sounds:"don, kon, ka, do, ko, ro, su, tsu,ku, kara, ra, doko",soundObj:{"":"",don:"don",kon:"kon",ka:"ka",do:"do",ko:"ko",ro:"ro",su:"su",tsu:"tsu",ku:"ku",kara:"kara",ra:"ra",doko:"doko"}}},{cells:[{sound:"don"},null,{sound:"ka",intensity:1},{sound:"don"},{sound:""},{sound:"ka",intensity:1},{sound:"don"},{sound:""},{sound:"don",intensity:1},null,{sound:"don",intensity:1},null,{sound:"do"},{sound:"ko"},{sound:"don",intensity:1},null,{sound:"do"},{sound:"ro"},{sound:"tsu"},{sound:"ku"},{sound:"su"},{sound:"ka",intensity:1},{sound:"ra",intensity:1},null,{sound:"do"},{sound:"kon",intensity:1},{sound:""},{sound:"ka",intensity:1},{sound:"su"},{sound:"ko"},{sound:"do"},{sound:"ko"},{sound:"don",intensity:1},null,null,{sound:"ko"},{sound:"don",intensity:1},{sound:"doko"},{sound:"kara",intensity:1},{sound:"don",intensity:1},{sound:"su"},{sound:"kon",intensity:1},null,{sound:"don",intensity:1},null,{sound:"ko"},{sound:"do",intensity:1},{sound:"do",intensity:1},{sound:"su"},{sound:"ka",intensity:1},{sound:"don",intensity:1},null,{sound:"su"},{sound:"do"},{sound:"ka",intensity:1},null,{sound:"su"},{sound:"don",intensity:1},null,null,{sound:"don",intensity:1}],id:2,sectionName:"Line 2",totalLines:4,settings:{cellsPerLine:4,divideEvery:2,sounds:"don, kon, ka",soundObj:{"":"",don:"don",kon:"kon",ka:"ka"}}}]},reducers:{clearState:function(e,n){e.sections=[j()]},setSettings:function(e,n){var t=n.payload,o=t.sectionId,s=t.settings;Object.keys(s).forEach((function(n){e.sections[o].settings[n]=s[n]})),e.sections[o].settings.soundObj=Object.fromEntries(",".concat(e.sections[o].settings.sounds).split(",").map((function(e){return[e.trim(),e.trim()]})))},setTotalLines:function(e,n){var t=n.payload,o=t.sectionIndex,s=t.totalLines,i=Math.max(s,1),c=e.sections[o].settings.cellsPerLine;e.sections[o].totalLines=i,e.sections[o].cells=e.sections[o].cells.slice(0,i*c)},setSectionName:function(e,n){var t=n.payload,o=t.sectionIndex,s=t.sectionName;e.sections[o].sectionName=s},setSound:function(e,n){var t=n.payload,o=t.sectionIndex,s=t.cellIndex,i=t.sound,c=e.sections[o].cells[s]||{};c.sound=i,e.sections[o].cells[s]=c},setIntensity:function(e,n){var t=n.payload,o=t.sectionIndex,s=t.cellIndex,i=t.intensity,c=e.sections[o].cells[s]||{};c.intensity=i,e.sections[o].cells[s]=c},setMainState:function(e,n){return n.payload},addSection:function(e,n){e.sections.push(j(e.sections.length+1))},removeLastSection:function(e,n){e.sections.pop()}}}),f=b.actions,v=(f.setCellsPerLine,f.setDivideEvery,f.setTotalLines),m=f.setSectionName,p=(f.setSounds,f.setSettings),x=f.setSound,O=f.setIntensity,h=f.setMainState,k=f.addSection,g=f.removeLastSection,y=f.clearState,w=b.reducer,C=t(7);function I(e){return function(n){"Enter"===n.key&&e(n)}}function L(e){return function(n){" "===n.key&&e(n)}}var N="cell",P={open:!1,menuCoordinates:void 0,cellIndex:void 0,sectionIndex:void 0},S=Object(r.b)({name:N,initialState:P,reducers:{setCellPopupState:function(e,n){var t=n.payload,o=t.sectionIndex,s=t.cellIndex,i=t.menuCoordinates,c=t.open;return Object(d.a)(Object(d.a)({},e),{},{sectionIndex:o,cellIndex:s,menuCoordinates:i,open:c})},setCellPopupOpen:function(e,n){e.open=n.payload},setCellPopupMenuCoordinates:function(e,n){e.menuCoordinates=n.payload},setCellPopupCellIndex:function(e,n){e.cellIndex=n.payload},setCellPopupSectionIndex:function(e,n){e.sectionIndex=n.payload}}}),E=S.actions,M=E.setCellPopupOpen,B=(E.setCellPopupMenuCoordinates,E.setCellPopupCellIndex,E.setCellPopupSectionIndex,E.setCellPopupState),W=S.reducer,D=t(0),R=function(e){var n=e.cellIndex,t=e.sectionIndex,s=e.isPlaying,i=e.isStartingCell,d=e.isFirstCellInLine,r=e.cellsPerLine,l=Object(o.useRef)(),a=Object(c.c)(),j=u(t),b=function(e,n){return Object(c.d)((function(t){return t.main.sections[e].cells[n]||{}}),c.b)}(t,n),f=b.sound,v=void 0===f?0:f,m=b.intensity,p=v&&j[v]||"",x="bg-white hover:bg-blue-400";s?x="bg-red-300 hover:bg-red-600":i&&(x="bg-gray-300 hover:bg-blue-400");var h="border border-blue-800";d&&r%2===1&&(h="border-2 border-red-400 md:border md:border-blue-800"),console.debug("Cell rerender ".concat(n));var k=function(e){var o;if(e.clientX&&e.clientY)o=[e.clientX,e.clientY];else if(e.target){var s=e.target.getBoundingClientRect();o=[s.x,s.y]}a(B({cellIndex:n,sectionIndex:t,open:!0,menuCoordinates:o})),e.preventDefault()},g=function(e){a(O({cellIndex:n,sectionIndex:t,intensity:m?0:1})),e.preventDefault()};return Object(D.jsx)("div",{ref:l,className:"fadeBg flex flex-row justify-center items-center select-none h-10 cursor-pointer ".concat(h," ").concat(x),role:"button",tabIndex:0,onContextMenu:g,onClick:k,onKeyPress:function(e){I(g)(e),L(k)(e)},children:m?p.toLocaleUpperCase():p})};R.defaultProps={isPlaying:void 0};var T=Object(o.memo)(R),H=t(14),_=["children","className"],J=function(e){var n=e.children,t=e.className,o=Object(H.a)(e,_);return Object(D.jsx)("button",Object(d.a)(Object(d.a)({type:"button",className:"p-3 bg-blue-100 text-gray-800 cursor-pointer hover:bg-blue-50 ".concat(t)},o),{},{children:n}))};J.defaultProps={className:void 0,children:void 0};var X=Object(o.memo)(J),Y=function(e){var n=e.children,t=e.onClick;return Object(D.jsx)(X,{className:"mr-2 spinIcon",onClick:t,children:n})},z=Object(o.memo)(Y);function A(){return Object(D.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[Object(D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),Object(D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}var F=t(1).useEffect;var K=function(e){var n=e.open,t=e.onOpenChange,s=e.className,i=e.style,c=e.children,r=e.left,l=e.top,a=Object(o.useRef)(),u=Object(o.useState)(),j=Object(C.a)(u,2),b=j[0],f=j[1],v=Object(o.useCallback)((function(e){n&&(t(!1),e.stopPropagation())}),[n,t]);!function(e,n){F((function(){var t=function(t){e.current&&!e.current.contains(t.target)&&n(t)};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),document.addEventListener("keypress",t),function(){document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t),document.removeEventListener("keypress",t)}}),[e,n])}(a,v),Object(o.useEffect)((function(){if(a.current&&void 0!==r&&void 0!==l){var e=window.innerWidth-a.current.clientWidth,n=window.innerHeight-a.current.clientHeight,t=Math.max(Math.min(r,e),10),o=Math.max(Math.min(l,n),10);f({left:t,top:o})}else f(null)}),[r,n,l]);var m=b?"":"invisible",p=function(e){e.preventDefault(),e.stopPropagation()};return n&&Object(D.jsx)("div",{ref:a,className:"popupmenu ".concat(m," ").concat(s),style:Object(d.a)(Object(d.a)({},i),b||{}),onClick:p,onKeyPress:I(p),role:"none",children:c})};K.defaultProps={className:"",style:null,children:void 0,left:void 0,top:void 0};var G=K,U=t(5),V=t(15),$=function(e){var n=e.children,t=e.id;return Object(D.jsx)("label",{htmlFor:t,className:"flex flex-row justify-between items-end mt-3 first:mt-0",children:n})};$.defaultProps={id:void 0,children:void 0};var q=Object(V.a)(Array(20).keys()).map((function(e){return e+1})),Q=function(e){var n=e.sectionId,t=a(n),s=Object(c.c)(),i=t.cellsPerLine,d=void 0===i?16:i,r=t.divideEvery,l=void 0===r?4:r,u=t.sounds,j=void 0===u?"ka,don":u,b=Object(o.useCallback)((function(e){var t=e.target,o=t.name,i=t.value,c="number"===t.dataType?Number(i):i;s(p({sectionId:n,settings:Object(U.a)({},o,c)}))}),[s,n]);return Object(D.jsxs)("form",{className:"flex flex-col ",children:[Object(D.jsxs)($,{children:["Cells Per Line",Object(D.jsx)("select",{id:"cellsPerLine",name:"cellsPerLine",className:"p-2 ",onChange:b,value:d,"data-data-type":"number",children:q.map((function(e){return Object(D.jsx)("option",{value:e,children:e},"cellsPerLine_".concat(e))}))})]}),Object(D.jsxs)($,{children:["Divide every",Object(D.jsx)("select",{id:"divideEvery",name:"divideEvery",className:"p-2 ",onChange:b,value:l,"data-data-type":"number",children:q.map((function(e){return Object(D.jsx)("option",{value:e,children:e},"defaultDivideEvery_".concat(e))}))})]}),Object(D.jsxs)($,{id:j,children:["Available Sounds",Object(D.jsx)("input",{id:"sounds",name:"sounds",className:"border-black border p-1 ml-5",onChange:b,value:j})]})]})};Q.defaultProps={};var Z=Object(o.memo)(Q),ee=function(e){var n=e.sectionId,t=e.open,o=e.onOpenChange,s=e.left,i=e.top;return Object(D.jsx)(G,{open:t,onOpenChange:o,left:s,top:i,className:"grid grid-rows-1 grid-cols-1 w-max max-h-48 p-4",children:Object(D.jsx)(Z,{sectionId:n})})};ee.defaultProps={left:void 0,top:void 0};var ne=ee,te=function(){return Object(D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 12H6"})})},oe=function(){return Object(D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})},se=function(e){var n,t=e.sectionId,s=a(t),i=s.cellsPerLine,r=s.divideEvery,l=Object(o.useState)(!1),u=Object(C.a)(l,2),j=u[0],b=u[1],f=Object(c.c)(),p=(n=t,Object(c.d)((function(e){var t=e.main.sections,o=Object(d.a)({},t[n]);return delete o.cells,o}),c.b)),x=p.sectionName,O=p.totalLines,h=p.id,k=[],g=i*O,y=Object(o.useState)(),w=Object(C.a)(y,2),I=w[0],L=w[1],N=Object(o.useState)(),P=Object(C.a)(N,2),S=P[0],E=P[1],M=i>7?Math.floor(i/2):i;console.debug("Section rerender ".concat(x," - ").concat(h));for(var B=0;B<g;B++)k.push(Object(D.jsx)(T,{isStartingCell:B%r===0,isFirstCellInLine:B%i===0,cellsPerLine:i,cellIndex:B,sectionIndex:t},"cell_".concat(t,"_").concat(B)));return Object(D.jsxs)("div",{className:"mb-8 p-1",children:[Object(D.jsxs)("div",{className:"flex flex-row align-baseline",children:[Object(D.jsx)(z,{onClick:function(){f(v({sectionIndex:t,totalLines:O+1}))},children:Object(D.jsx)(oe,{})}),Object(D.jsx)(z,{onClick:function(){f(v({sectionIndex:t,totalLines:O-1}))},children:Object(D.jsx)(te,{})}),Object(D.jsxs)(z,{onClick:function(e){if(b(!0),e.clientX&&e.clientY)L(e.clientX),E(e.clientY);else if(e.target){var n=e.target.getBoundingClientRect(),t=n.x,o=n.y;L(t),E(o)}e.preventDefault(),e.stopPropagation()},children:[Object(D.jsx)(A,{}),Object(D.jsx)(ne,{sectionId:t,open:j,onOpenChange:function(e){b(e)},left:I,top:S})]}),Object(D.jsx)("input",{type:"text",value:x,className:"text-2xl w-full outline-none",onChange:function(e){f(m({sectionIndex:t,sectionName:e.target.value}))}})]}),Object(D.jsx)("div",{className:"bg-blue-500 grid grid-cols-".concat(M," md:grid-cols-").concat(i," border border-blue-800"),children:k})]},"section_".concat(t))};se.defaultProps={sectionId:void 0};var ie,ce=Object(o.memo)(se),de={reducer:(ie={},Object(U.a)(ie,l,w),Object(U.a)(ie,N,W),ie)},re=Object(r.a)(de),le="taikoNotesState",ae=function(){var e=re.getState().main;localStorage.setItem(le,JSON.stringify(e))},ue=function(e){var n=Object.assign({},e);return Object(D.jsx)(X,Object(d.a)({},n))},je=function(){var e=Object(c.c)();return Object(D.jsxs)("div",{className:"settings p-1 mt-3 mb-3 flex flex-col md:flex-row",children:[Object(D.jsx)("div",{className:"w-full md:w-8/12 lg:w-6/12 grid logoGrid mr-3",children:Object(D.jsx)("img",{src:"".concat("","/favicon/Taiko.svg"),className:"w-full p-2",alt:"taiko logo"})}),Object(D.jsx)("div",{className:"w-full md:w-4/12 lg:w-6/12 flex flex-col justify-between",children:Object(D.jsxs)("div",{className:"mt-2 md:mt-0 grid grid-rows-2 grid-flow-col gap-1",children:[Object(D.jsx)(ue,{onClick:function(){e(k())},children:"Add Section"}),Object(D.jsx)(ue,{onClick:function(){e(g())},children:"Remove Last Section"}),Object(D.jsx)(ue,{onClick:function(){ae()},children:"Save"}),Object(D.jsx)(ue,{onClick:function(){var n=function(){var e=localStorage.getItem(le);return e?JSON.parse(e):null}();console.debug("entire state",n),e(h(n))},children:"Load"}),Object(D.jsx)(ue,{onClick:function(){e(y())},children:"Clear"})]})})]})};je.defaultProps={};var be=Object(o.memo)(je),fe=function(){var e=Object(c.d)((function(e){return e.main.sections.map((function(e){return e.id}))}),c.b);return console.debug("TaikoGrid rerender"),Object(D.jsxs)("div",{children:[Object(D.jsx)(be,{}),Object(D.jsx)("div",{children:e.map((function(e,n){return Object(D.jsx)(ce,{sectionId:n},e)}))})]})},ve=Object(o.memo)(fe),me=function(e){var n=e.children;return Object(D.jsx)("div",{className:"container mx-auto",children:n})};me.defaultProps={children:"asd"};var pe=me,xe=function(){return Object(D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(D.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})})},Oe=function(){var e=Object(c.d)((function(e){return e.cell.sectionIndex}),c.b),n=u(e),t=n?Math.ceil(Object.keys(n).length/4):0,s=Object(c.c)(),i=Object(o.useRef)(),d=Object(c.d)((function(e){return e.cell.cellIndex}),c.b),r=Object(c.d)((function(e){return e.cell.menuCoordinates}),c.b),l=Object(c.d)((function(e){return e.cell.open}),c.b);return Object(o.useEffect)((function(){l&&setTimeout((function(){i.current&&i.current.focus()}),0)}),[l]),console.debug("CellPopupMenu rerender"),l&&Object(D.jsx)(G,{open:l,left:r[0],top:r[1],onOpenChange:function(e){s(M(e))},children:Object(D.jsxs)("div",{className:"flex",children:[Object(D.jsx)("div",{className:"grid grid-rows-4 grid-cols-".concat(t," grid-flow-col w-max max-h-48"),children:Object.values(n).map((function(n,t){var o=function(t){s(x({cellIndex:d,sectionIndex:e,sound:n}))};return Object(D.jsx)("div",{ref:0===t?i:null,className:"p-3 hover:bg-blue-200 ",role:"button",tabIndex:0,onClick:o,onKeyPress:function(e){I((function(){}))(e),L(o)(e)},children:n},n)}))}),Object(D.jsx)("div",{className:"border-0 border-l-2 border-gray-200 grid grid-rows-4 grid-cols-1 grid-flow-col w-max max-h-48",children:Object(D.jsx)("div",{className:"p-3 hover:bg-blue-200 ",children:Object(D.jsx)(xe,{})})})]})})};Oe.defaultProps={};var he=Object(o.memo)(Oe);var ke=function(){return Object(D.jsx)(c.a,{store:re,children:Object(D.jsx)("div",{className:"app",children:Object(D.jsxs)(pe,{children:[Object(D.jsx)(ve,{}),Object(D.jsx)(he,{})]})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(D.jsx)(ke,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[26,1,2]]]);
//# sourceMappingURL=main.a1fde519.chunk.js.map