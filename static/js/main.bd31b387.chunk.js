(this.webpackJsonptaikonotes=this.webpackJsonptaikonotes||[]).push([[0],{20:function(e,n,t){},26:function(e,n,t){"use strict";t.r(n);var s=t(0),c=t(7),o=t.n(c),i=(t(20),t(2)),d=t(5),l=t(10),a=t(4),r=t(9),u="main",x=function(){return Object(i.d)((function(e){return e.main.settings}),i.b)},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{cells:[],id:e,name:"Line ".concat(e),totalLines:1}},j=Object(r.b)({name:u,initialState:{sections:[{cells:[{soundIndex:1},null,{soundIndex:3,intensity:1},{soundIndex:1},{soundIndex:0},{soundIndex:3,intensity:1},{soundIndex:1},{soundIndex:0},{soundIndex:1,intensity:1},null,{soundIndex:1,intensity:1},null,{soundIndex:4},{soundIndex:5},{soundIndex:1,intensity:1},null,{soundIndex:4},{soundIndex:6},{soundIndex:8},{soundIndex:9},{soundIndex:7},{soundIndex:3,intensity:1},{soundIndex:11,intensity:1},null,{soundIndex:4},{soundIndex:2,intensity:1},{soundIndex:0},{soundIndex:3,intensity:1},{soundIndex:7},{soundIndex:5},{soundIndex:4},{soundIndex:5},{soundIndex:1,intensity:1},null,null,{soundIndex:5},{soundIndex:1,intensity:1},{soundIndex:12},{soundIndex:10,intensity:1},{soundIndex:1,intensity:1},{soundIndex:7},{soundIndex:2,intensity:1},null,{soundIndex:1,intensity:1},null,{soundIndex:5},{soundIndex:4,intensity:1},{soundIndex:4,intensity:1},{soundIndex:7},{soundIndex:3,intensity:1},{soundIndex:1,intensity:1},null,{soundIndex:7},{soundIndex:4},{soundIndex:3,intensity:1},null,{soundIndex:7},{soundIndex:1,intensity:1},null,null,{soundIndex:1,intensity:1}],id:1,name:"Line 1",totalLines:4},{cells:[],id:2,name:"Line 2",totalLines:1}],settings:{cellsPerLine:16,divideEvery:2,sounds:"don, kon, ka, do, ko, ro, su, tsu,ku, kara, ra, doko"}},reducers:{clearState:function(e,n){e.sections=[b()]},setSettings:function(e,n){Object.keys(n.payload).forEach((function(t){e.settings[t]=n.payload[t]}))},setTotalLines:function(e,n){var t=n.payload,s=t.sectionIndex,c=t.totalLines,o=Math.max(c,1),i=e.settings.cellsPerLine;e.sections[s].totalLines=o,e.sections[s].cells=e.sections[s].cells.slice(0,o*i)},setSoundIndex:function(e,n){var t=n.payload,s=t.sectionIndex,c=t.cellIndex,o=t.soundIndex,i=e.sections[s].cells[c]||{};i.soundIndex=o,e.sections[s].cells[c]=i},setIntensity:function(e,n){var t=n.payload,s=t.sectionIndex,c=t.cellIndex,o=t.intensity,i=e.sections[s].cells[c]||{};i.intensity=o,e.sections[s].cells[c]=i},setMainState:function(e,n){return n.payload},addSection:function(e,n){e.sections.push(b(e.sections.length+1))},removeLastSection:function(e,n){e.sections.pop()}}}),m=j.actions,f=(m.setCellsPerLine,m.setDivideEvery,m.setTotalLines),v=(m.setSounds,m.setSettings),O=m.setSoundIndex,I=m.setIntensity,h=m.setMainState,p=m.addSection,y=m.removeLastSection,g=m.clearState,N=j.reducer,w=t(1),L=Object(l.a)(Array(20).keys()).map((function(e){return e+1})),k=function(){var e=x(),n=Object(i.c)(),t=e.cellsPerLine,s=e.divideEvery,c=e.sounds,o=function(e){var t=e.target,s=t.name,c=t.value,o="number"===t.dataType?Number(c):c;n(v(Object(d.a)({},s,o)))};return Object(w.jsxs)("form",{onSubmit:function(){},className:"flex flex-col ",children:[Object(w.jsxs)("div",{className:"flex flex-row justify-between",children:[Object(w.jsx)("label",{children:"Cells Per Line"}),Object(w.jsx)("select",{name:"cellsPerLine",className:"p-2 ",onChange:o,value:t,"data-data-type":"number",children:L.map((function(e){return Object(w.jsx)("option",{value:e,children:e},"cellsPerLine_".concat(e))}))})]}),Object(w.jsxs)("div",{className:"flex flex-row justify-between",children:[Object(w.jsx)("label",{children:"Divide every"}),Object(w.jsx)("select",{name:"divideEvery",className:"p-2 ",onChange:o,value:s,"data-data-type":"number",children:L.map((function(e){return Object(w.jsx)("option",{value:e,children:e},"defaultDivideEvery_".concat(e))}))})]}),Object(w.jsxs)("div",{className:"flex flex-row justify-between items-end mt-3",children:[Object(w.jsx)("label",{children:"Available Sounds"}),Object(w.jsx)("input",{name:"sounds",className:"border-black border p-1",onChange:o,value:c})]})]})};k.defaultProps={};var S=Object(s.memo)(k),C=t(15),P=["children","className"],E=function(e){var n=e.children,t=e.className,s=Object(C.a)(e,P);return Object(w.jsx)("button",Object(a.a)(Object(a.a)({type:"button",className:"p-3 bg-blue-100 text-gray-800 cursor-pointer hover:opacity-75 ".concat(t)},s),{},{children:n}))};E.defaultProps={className:void 0,children:void 0};var A=Object(s.memo)(E),M={reducer:Object(d.a)({},u,N)},D=Object(r.a)(M),T="taikoNotesState",_=function(){var e=D.getState().main;localStorage.setItem(T,JSON.stringify(e))},J=t(14),B=t(0).useEffect;var R=function(e){var n=e.cellIndex,t=e.open,c=e.onOpenChange,o=e.soundArray,d=e.sectionIndex,l=e.menuCoordinates,a=Math.ceil(o.length/4),r=Object(i.c)(),u=Object(s.useRef)(),x=Object(s.useCallback)((function(e){c(!1),e.preventDefault(),e.stopPropagation()}),[c]);return function(e,n){B((function(){var t=function(t){e.current&&!e.current.contains(t.target)&&n(t)};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),function(){document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)}}),[e,n])}(u,x),console.debug("PopupMenu rerender"),t&&Object(w.jsx)("div",{ref:u,className:"popupmenu grid grid-rows-4 grid-cols-".concat(a," w-max grid-flow-col max-h-48"),style:l&&{top:l[1]-50,left:l[0]},children:o.map((function(e,t){return Object(w.jsx)("div",{className:"p-3 hover:bg-blue-200 ",onClick:function(e){r(O({cellIndex:n,sectionIndex:d,soundIndex:t})),x(e)},children:e},t)}))})};R.defaultProps={menuCoordinates:void 0};var W=Object(s.memo)(R),G=function(e){var n,t=e.soundArray,c=void 0===t?[]:t,o=e.cellIndex,d=e.sectionIndex,l=e.isPlaying,a=e.isStartingCell,r=Object(i.c)(),u=Object(s.useState)(!1),x=Object(J.a)(u,2),b=x[0],j=x[1],m=Object(s.useState)(),f=Object(J.a)(m,2),v=f[0],O=f[1],h=Object(s.useCallback)((function(e){j(e)}),[]),p=function(e,n){return Object(i.d)((function(t){return t.main.sections[e].cells[n]||{}}),i.b)}(d,o),y=p.soundIndex,g=void 0===y?0:y,N=p.intensity,L=c[g]||"";return n=l?"bg-red-300 hover:bg-red-600":a?"bg-gray-300 hover:bg-blue-400":"hover:bg-blue-400",console.debug("Cell rerender ".concat(o)),Object(w.jsxs)("div",{className:"flex flex-row justify-center items-center select-none border border-blue-800 h-10 cursor-pointer ".concat(n),onClick:function(){r(I({cellIndex:o,sectionIndex:d,intensity:N?0:1}))},onContextMenu:function(e){j(!0),O([e.clientX,e.clientY]),e.preventDefault()},children:[N?L.toLocaleUpperCase():L,Object(w.jsx)(W,{open:b,menuCoordinates:v,onOpenChange:h,cellIndex:o,sectionIndex:d,soundArray:c})]})};G.defaultProps={isPlaying:void 0};var U=Object(s.memo)(G),X=function(e){var n,t=e.sectionId,c=x(),o=c.cellsPerLine,d=c.divideEvery,r=c.sounds,u=Object(i.c)(),b=(n=t,Object(i.d)((function(e){var t=e.main.sections,s=Object(a.a)({},t[n]);return delete s.cells,s}),i.b)),j=Object(s.useMemo)((function(){return[null].concat(Object(l.a)(r.split(",").map((function(e){return e.trim()}))))}),[r]),m=b.name,v=b.totalLines,O=b.id,I=[],h=o*v;console.debug("Section rerender ".concat(m," - ").concat(O));for(var p=0;p<h;p++)I.push(Object(w.jsx)(U,{isStartingCell:p%d===0,cellsPerLine:o,cellIndex:p,sectionIndex:t,soundArray:j},"cell_".concat(t,"_").concat(p)));return Object(w.jsxs)("div",{className:"mb-8",children:[Object(w.jsx)("h2",{className:"text-2xl mb-2",children:m}),Object(w.jsx)("div",{className:"grid grid-cols-".concat(o," border border-blue-800"),children:I}),Object(w.jsxs)("div",{children:[Object(w.jsx)(A,{onClick:function(){u(f({sectionIndex:t,totalLines:v-1}))},children:"-"}),Object(w.jsx)(A,{className:"mr-2",onClick:function(){u(f({sectionIndex:t,totalLines:v+1}))},children:"+"})]})]},"section_".concat(t))};X.defaultProps={sectionId:void 0};var Y=Object(s.memo)(X),$=function(){var e=Object(i.c)(),n=Object(i.d)((function(e){return e.main.sections.map((function(e){return e.id}))}),i.b);return console.debug("TaikoGrid rerender"),Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{className:"settings mt-3 mb-3 p-3 flex flex-row",children:[Object(w.jsx)("img",{src:"".concat("","/favicon/Taiko.svg"),className:"w-1/12 pr-2",alt:"taiko logo"}),Object(w.jsx)("div",{className:"w-full md:w-6/12 lg:w-4/12 border border-blue-300 p-2 mr-auto w-full",children:Object(w.jsx)(S,{})}),Object(w.jsx)("div",{className:"w-full md:w-6/12 lg:w-4/12 flex flex-col justify-between",children:Object(w.jsxs)("div",{className:"grid grid-rows-2 grid-flow-col",children:[Object(w.jsx)(A,{onClick:function(){e(p())},className:"m-4",children:"Add Section"}),Object(w.jsx)(A,{onClick:function(){e(y())},className:"m-4",children:"Remove Last Section"}),Object(w.jsx)(A,{onClick:function(){_()},className:"m-4",children:"Save"}),Object(w.jsx)(A,{onClick:function(){var n=function(){var e=localStorage.getItem(T);return e?JSON.parse(e):null}();console.debug("entire state",n),e(h(n))},className:"m-4",children:"Load"}),Object(w.jsx)(A,{onClick:function(){e(g())},className:"m-4",children:"Clear"})]})})]}),Object(w.jsx)("div",{children:n.map((function(e,n){return Object(w.jsx)(Y,{sectionId:n},e)}))})]})},q=Object(s.memo)($),z=function(e){var n=e.children;return Object(w.jsx)("div",{className:"container mx-auto",children:n})};z.defaultProps={children:"asd"};var F=z;var H=function(){return Object(w.jsx)(i.a,{store:D,children:Object(w.jsx)("div",{className:"app",children:Object(w.jsx)(F,{children:Object(w.jsx)(q,{})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(w.jsx)(H,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[26,1,2]]]);
//# sourceMappingURL=main.bd31b387.chunk.js.map