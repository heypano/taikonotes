(this.webpackJsonptaikonotes=this.webpackJsonptaikonotes||[]).push([[0],{20:function(e,n,t){},26:function(e,n,t){"use strict";t.r(n);var o=t(0),s=t(8),c=t.n(s),i=(t(20),t(2)),a=t(5),r=t(15),l=t(4),d=t(10),u="main",b=function(){return Object(i.d)((function(e){return e.main.settings}),i.b)},j=function(){return Object(i.d)((function(e){return e.main.settings.soundObj}),i.b)},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{cells:[],id:e,sectionName:"Line ".concat(e),totalLines:1}},f=Object(d.b)({name:u,initialState:{sections:[{cells:[{sound:"don"},null,{sound:"ka",intensity:1},{sound:"don"},{sound:""},{sound:"ka",intensity:1},{sound:"don"},{sound:""},{sound:"don",intensity:1},null,{sound:"don",intensity:1},null,{sound:"do"},{sound:"ko"},{sound:"don",intensity:1},null,{sound:"do"},{sound:"ro"},{sound:"tsu"},{sound:"ku"},{sound:"su"},{sound:"ka",intensity:1},{sound:"ra",intensity:1},null,{sound:"do"},{sound:"kon",intensity:1},{sound:""},{sound:"ka",intensity:1},{sound:"su"},{sound:"ko"},{sound:"do"},{sound:"ko"},{sound:"don",intensity:1},null,null,{sound:"ko"},{sound:"don",intensity:1},{sound:"doko"},{sound:"kara",intensity:1},{sound:"don",intensity:1},{sound:"su"},{sound:"kon",intensity:1},null,{sound:"don",intensity:1},null,{sound:"ko"},{sound:"do",intensity:1},{sound:"do",intensity:1},{sound:"su"},{sound:"ka",intensity:1},{sound:"don",intensity:1},null,{sound:"su"},{sound:"do"},{sound:"ka",intensity:1},null,{sound:"su"},{sound:"don",intensity:1},null,null,{sound:"don",intensity:1}],id:1,sectionName:"Line 1",totalLines:4}],settings:{cellsPerLine:16,divideEvery:2,sounds:"don, kon, ka, do, ko, ro, su, tsu,ku, kara, ra, doko",soundObj:{don:"don",kon:"kon",ka:"ka",do:"do",ko:"ko",ro:"ro",su:"su",tsu:"tsu",ku:"ku",kara:"kara",ra:"ra",doko:"doko"}}},reducers:{clearState:function(e,n){e.sections=[m()]},setSettings:function(e,n){Object.keys(n.payload).forEach((function(t){e.settings[t]=n.payload[t]})),e.settings.soundObj=Object.fromEntries(e.settings.sounds.split(",").map((function(e){return[e.trim(),e.trim()]}))),e.sections.forEach((function(n){n.cells.forEach((function(n){n&&(n.sound=e.settings.soundObj[n.sound]?n.sound:"")}))}))},setTotalLines:function(e,n){var t=n.payload,o=t.sectionIndex,s=t.totalLines,c=Math.max(s,1),i=e.settings.cellsPerLine;e.sections[o].totalLines=c,e.sections[o].cells=e.sections[o].cells.slice(0,c*i)},setSectionName:function(e,n){var t=n.payload,o=t.sectionIndex,s=t.sectionName;e.sections[o].sectionName=s},setSound:function(e,n){var t=n.payload,o=t.sectionIndex,s=t.cellIndex,c=t.sound,i=e.sections[o].cells[s]||{};i.sound=c,e.sections[o].cells[s]=i},setIntensity:function(e,n){var t=n.payload,o=t.sectionIndex,s=t.cellIndex,c=t.intensity,i=e.sections[o].cells[s]||{};i.intensity=c,e.sections[o].cells[s]=i},setMainState:function(e,n){return n.payload},addSection:function(e,n){e.sections.push(m(e.sections.length+1))},removeLastSection:function(e,n){e.sections.pop()}}}),v=f.actions,x=(v.setCellsPerLine,v.setDivideEvery,v.setTotalLines),O=v.setSectionName,h=(v.setSounds,v.setSettings),g=v.setSound,p=v.setIntensity,y=v.setMainState,k=v.addSection,N=v.removeLastSection,w=v.clearState,S=f.reducer,I=t(1),L=Object(r.a)(Array(20).keys()).map((function(e){return e+1})),C=function(){var e=b(),n=Object(i.c)(),t=e.cellsPerLine,o=e.divideEvery,s=e.sounds,c=function(e){var t=e.target,o=t.name,s=t.value,c="number"===t.dataType?Number(s):s;n(h(Object(a.a)({},o,c)))};return Object(I.jsxs)("form",{onSubmit:function(){},className:"flex flex-col border border-blue-300 p-2",children:[Object(I.jsxs)("div",{className:"flex flex-row justify-between",children:[Object(I.jsx)("label",{children:"Cells Per Line"}),Object(I.jsx)("select",{name:"cellsPerLine",className:"p-2 ",onChange:c,value:t,"data-data-type":"number",children:L.map((function(e){return Object(I.jsx)("option",{value:e,children:e},"cellsPerLine_".concat(e))}))})]}),Object(I.jsxs)("div",{className:"flex flex-row justify-between",children:[Object(I.jsx)("label",{children:"Divide every"}),Object(I.jsx)("select",{name:"divideEvery",className:"p-2 ",onChange:c,value:o,"data-data-type":"number",children:L.map((function(e){return Object(I.jsx)("option",{value:e,children:e},"defaultDivideEvery_".concat(e))}))})]}),Object(I.jsxs)("div",{className:"flex flex-row justify-between items-end mt-3",children:[Object(I.jsx)("label",{children:"Available Sounds"}),Object(I.jsx)("input",{name:"sounds",className:"border-black border p-1",onChange:c,value:s})]})]})};C.defaultProps={};var P=Object(o.memo)(C),E=t(14),M=["children","className"],D=function(e){var n=e.children,t=e.className,o=Object(E.a)(e,M);return Object(I.jsx)("button",Object(l.a)(Object(l.a)({type:"button",className:"p-3 bg-blue-100 text-gray-800 cursor-pointer hover:opacity-75 ".concat(t)},o),{},{children:n}))};D.defaultProps={className:void 0,children:void 0};var T=Object(o.memo)(D),_={reducer:Object(a.a)({},u,S)},J=Object(d.a)(_),W="taikoNotesState",A=function(){var e=J.getState().main;localStorage.setItem(W,JSON.stringify(e))},B=t(7),H=t(0).useEffect;var R=function(e){var n=e.cellIndex,t=e.open,s=e.onOpenChange,c=e.sectionIndex,a=e.menuCoordinates,r=j(),l=Math.ceil(Object.keys(r).length/4),d=Object(i.c)(),u=Object(o.useRef)(),b=Object(o.useCallback)((function(e){s(!1),e.stopPropagation()}),[s]),m=Object(o.useState)(),f=Object(B.a)(m,2),v=f[0],x=f[1];return function(e,n){H((function(){var t=function(t){e.current&&!e.current.contains(t.target)&&n(t)};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),function(){document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)}}),[e,n])}(u,b),console.debug("PopupMenu rerender"),Object(o.useEffect)((function(){if(u.current&&a){var e=window.innerWidth-u.current.clientWidth,n=window.innerHeight-u.current.clientHeight,t=Math.max(Math.min(a[0]-10,e),10),o=Math.max(Math.min(a[1]-10,n),10);x({left:t,top:o})}else x(null)}),[t,a]),console.log(r),t&&Object(I.jsx)("div",{ref:u,className:"popupmenu grid grid-rows-4 grid-cols-".concat(l," w-max grid-flow-col max-h-48 ").concat(v?"":"invisible"," "),style:v,children:Object.values(r).map((function(e){return Object(I.jsx)("div",{className:"p-3 hover:bg-blue-200 ",onClick:function(t){d(g({cellIndex:n,sectionIndex:c,sound:e})),b(t)},children:e},e)}))})};R.defaultProps={menuCoordinates:void 0};var G=Object(o.memo)(R),U=function(e){var n,t=e.cellIndex,s=e.sectionIndex,c=e.isPlaying,a=e.isStartingCell,r=Object(i.c)(),l=j(),d=Object(o.useState)(!1),u=Object(B.a)(d,2),b=u[0],m=u[1],f=Object(o.useState)(),v=Object(B.a)(f,2),x=v[0],O=v[1],h=Object(o.useCallback)((function(e){m(e)}),[]),g=function(e,n){return Object(i.d)((function(t){return t.main.sections[e].cells[n]||{}}),i.b)}(s,t),y=g.sound,k=void 0===y?0:y,N=g.intensity,w=k&&l[k]||"";return n=c?"bg-red-300 hover:bg-red-600":a?"bg-gray-300 hover:bg-blue-400":"hover:bg-blue-400",console.debug("Cell rerender ".concat(t)),Object(I.jsxs)("div",{className:"fadeBg flex flex-row justify-center items-center select-none border border-blue-800 h-10 cursor-pointer ".concat(n),onContextMenu:function(e){r(p({cellIndex:t,sectionIndex:s,intensity:N?0:1})),e.preventDefault()},onClick:function(e){m(!0),O([e.clientX,e.clientY]),e.preventDefault()},children:[N?w.toLocaleUpperCase():w,Object(I.jsx)(G,{open:b,menuCoordinates:x,onOpenChange:h,cellIndex:t,sectionIndex:s})]})};U.defaultProps={isPlaying:void 0};var X=Object(o.memo)(U),Y=function(e){var n,t=e.sectionId,o=b(),s=o.cellsPerLine,c=o.divideEvery,a=(o.sounds,Object(i.c)()),r=(n=t,Object(i.d)((function(e){var t=e.main.sections,o=Object(l.a)({},t[n]);return delete o.cells,o}),i.b)),d=r.sectionName,u=r.totalLines,j=r.id,m=[],f=s*u,v=s>7?Math.floor(s/2):s;console.debug("Section rerender ".concat(d," - ").concat(j));for(var h=0;h<f;h++)m.push(Object(I.jsx)(X,{isStartingCell:h%c===0,cellsPerLine:s,cellIndex:h,sectionIndex:t},"cell_".concat(t,"_").concat(h)));return Object(I.jsxs)("div",{className:"mb-8 p-1",children:[Object(I.jsxs)("div",{children:[Object(I.jsx)(T,{className:"mr-2",onClick:function(){a(x({sectionIndex:t,totalLines:u+1}))},children:"+"}),Object(I.jsx)(T,{className:"mr-2",onClick:function(){a(x({sectionIndex:t,totalLines:u-1}))},children:"-"}),Object(I.jsx)("input",{type:"text",value:d,className:"text-2xl  outline-none",onChange:function(e){a(O({sectionIndex:t,sectionName:e.target.value}))}})]}),Object(I.jsx)("div",{className:"grid grid-cols-".concat(v," md:grid-cols-").concat(s," border border-blue-800"),children:m})]},"section_".concat(t))};Y.defaultProps={sectionId:void 0};var $=Object(o.memo)(Y),q=function(){var e=Object(i.c)(),n=Object(i.d)((function(e){return e.main.sections.map((function(e){return e.id}))}),i.b);return console.debug("TaikoGrid rerender"),Object(I.jsxs)("div",{children:[Object(I.jsxs)("div",{className:"settings p-1 mt-3 mb-3 flex flex-col md:flex-row",children:[Object(I.jsxs)("div",{className:"w-full md:w-8/12 lg:w-6/12 flex justify-between mr-3",children:[Object(I.jsx)("img",{src:"".concat("","/favicon/Taiko.svg"),className:"w-40 p-2",alt:"taiko logo"}),Object(I.jsx)(P,{})]}),Object(I.jsx)("div",{className:"w-full md:w-4/12 lg:w-6/12 flex flex-col justify-between",children:Object(I.jsxs)("div",{className:"mt-2 md:mt-0 grid grid-rows-2 grid-flow-col gap-1",children:[Object(I.jsx)(T,{onClick:function(){e(k())},children:"Add Section"}),Object(I.jsx)(T,{onClick:function(){e(N())},children:"Remove Last Section"}),Object(I.jsx)(T,{onClick:function(){A()},children:"Save"}),Object(I.jsx)(T,{onClick:function(){var n=function(){var e=localStorage.getItem(W);return e?JSON.parse(e):null}();console.debug("entire state",n),e(y(n))},children:"Load"}),Object(I.jsx)(T,{onClick:function(){e(w())},children:"Clear"})]})})]}),Object(I.jsx)("div",{children:n.map((function(e,n){return Object(I.jsx)($,{sectionId:n},e)}))})]})},z=Object(o.memo)(q),F=function(e){var n=e.children;return Object(I.jsx)("div",{className:"container mx-auto",children:n})};F.defaultProps={children:"asd"};var K=F;var Q=function(){return Object(I.jsx)(i.a,{store:J,children:Object(I.jsx)("div",{className:"app",children:Object(I.jsx)(K,{children:Object(I.jsx)(z,{})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(I.jsx)(Q,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[26,1,2]]]);
//# sourceMappingURL=main.0effc0c8.chunk.js.map